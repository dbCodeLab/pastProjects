LD=g++
LDFLAGS=-lX11 -lXt -lXext -lXmu -lm -O3 -funroll-loops
CPPFLAGS=-O3 -funroll-loops
# -funroll-loops
# -fprofile-arcs -ftest-coverage

main: main.o XApplication.o XScreenRgbInfo.o XEngine.o XRasterizer.o XTextureLoaderPPM.o \
      Plane.o BspTree.o VertexSet.o Texture.o Door.o Elevator.o ScreenRender.o
	$(LD) $^ -o $@ $(LDFLAGS)

main.o: main.cc
	$(LD) -c $^ $(CPPFLAGS)

XApplication.o: XApplication.cc
	$(LD) -c $^ $(LDFLAGS) $(CPPFLAGS) -DSHM_EXT

# metti -DSHM_EXT nelle opzioni di compilazione di Xapp per usare l'shm

XScreenRgbInfo.o: XScreenRgbInfo.cc
	$(LD) -c $^ $(LDFLAGS) $(CPPFLAGS)

XEngine.o: XEngine.cc
	$(LD) -c $^ $(CPPFLAGS)

XRasterizer.o: XRasterizer.cc
	$(LD) -c $^ $(CPPFLAGS)

XTextureLoaderPPM.o: XTextureLoaderPPM.cc
	$(LD) -c $^ $(CPPFLAGS)

Plane.o: Plane.cc
	$(LD) -c $^ $(CPPFLAGS)

BspTree.o: BspTree.cc
	$(LD) -c $^ $(CPPFLAGS)

VertexSet.o: VertexSet.cc
	$(LD) -c $^ $(CPPFLAGS)

Texture.o: Texture.cc
	$(LD) -c $^ $(CPPFLAGS)

Door.o: Door.cc
	$(LD) -c $^ $(CPPFLAGS)

Elevator.o: Elevator.cc
	$(LD) -c $^ $(CPPFLAGS)

ScreenRender.o: ScreenRender.cc
	$(LD) -c $^ $(CPPFLAGS)	

clean:
	rm main main.o XApplication.o XScreenRgbInfo.o XEngine.o XRasterizer.o \
	   XTextureLoaderPPM.o Plane.o BspTree.o VertexSet.o Texture.o Door.o Sector.o Elevator.o \
	   ScreenRender.o	

asm:
	$(LD) -S XEngine.cc $(CPPFLAGS)

